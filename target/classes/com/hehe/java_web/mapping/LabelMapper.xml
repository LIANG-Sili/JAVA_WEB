<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hehe.java_web.dao.ILabelDao">

    <resultMap id="BaseResultMap" type="com.hehe.java_web.pojo.Label">
        <id column="LID" property="LID" jdbcType="INTEGER"/>
        <result column="LName" property="LName" jdbcType="VARCHAR"/>
    </resultMap>

    <!--获取所有标签-->
    <select id="selectLabelAll" resultMap="BaseResultMap">
      SELECT * FROM Lable
      ORDER BY LID
      LIMIT #{offset}, #{limit}
  </select>

    <!-- 获取标签的所有贴子-->
    <select id="selectPostBelongLabelAll" resultMap="BaseResultMap">
      SELECT * FROM Post
      where PID in (
      SELECT PID
      FROM PostBelongLable
      where LID = #{label.LID})
      ORDER BY PID
      LIMIT #{offset}, #{limit}
    </select>

    <!--获取关注标签的用户-->
    <select id="selectUserCollectLabelAll" resultMap="BaseResultMap">
      SELECT * FROM User
      where UID in (
      SELECT UID
      FROM UserCollectionLable
      where LID = #{label.LID})
      ORDER BY UID
      LIMIT #{offset}, #{limit}
    </select>


    <!-- 插入label -->
    <insert id="insertLabel" parameterType="com.hehe.java_web.pojo.Label">
    INSERT INTO Label
    VALUES (default ,#{LName, jdbcType=VARCHAR})
  </insert>

    <!-- 删除label -->
    <delete id="deleteLabel" parameterType="com.hehe.java_web.pojo.Label">
    DELETE FROM Label
    WHERE LID = #{LID, jdbcType=INTEGER}
  </delete>

</mapper>